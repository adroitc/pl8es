<%=
raw(Jsonify::Builder.plain do |j|
  
  j.locations(@req_locations) do |location|
    j.id                         location.id
    
    j.restaurant_image_url                  location.user.restaurant_image.present? ? location.user.restaurant_image.url(:cropped_dailycious_retina) : nil
    j.restaurant_image_fingerprint  location.user.restaurant_image.present? ? location.user.restaurant_image_fingerprint : nil

    j.name                       location.user.name
    
    j.address                    location.address
    j.zip                        location.zip
    j.city                       location.city
    j.country                    location.country

    j.telephone                  location.user.telephone
    j.website                    location.user.website
    
    j.distance                   location.distance
    j.latitude                   location.latitude
    j.longitude                  location.longitude
    
    j.daily_dishes(location.user.daily_dishes.where(:display_date => Date.today.to_datetime)) do |daily_dish|
      j.image_map_url              daily_dish.image.present? ? daily_dish.image.url(:cropped_map_retina) : nil     
      j.image_small_url            daily_dish.image.present? ? daily_dish.image.url(:cropped_small_retina) : nilj.image_url                  daily_dish.image.present? ? daily_dish.image.url(:cropped_default_retina) : nil
      j.image_fingerprint          daily_dish.image.present? ? daily_dish.image_fingerprint : nil
      j.title                      daily_dish.title
      j.price                      daily_dish.price
    end
  end
  
end)
%>